<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Canlı Desen Oluşturucu</title>
    <style>
        :root {
            --bg-color: #0f0f13;
            --panel-bg: #1a1a23;
            --text-color: #e0e0e0;
            --accent-color: #00d2ff;
            --border-color: #333;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Segoe UI', sans-serif;
            height: 100vh;
            display: flex;
            overflow: hidden; /* Kaydırmayı engelle, içerik kendi içinde kayacak */
        }

        /* MASAÜSTÜ GÖRÜNÜMÜ (Varsayılan: Yan yana) */
        .app-container {
            display: flex;
            width: 100%;
            height: 100%;
        }

        /* Sol/Üst Panel: Canvas (Çizim) */
        .canvas-section {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            background-color: #000;
            overflow: hidden;
        }

        canvas {
            box-shadow: 0 0 20px rgba(0, 210, 255, 0.1);
        }

        /* Sağ/Alt Panel: Kontroller */
        .controls-section {
            flex: 0 0 350px; /* Sabit genişlik */
            background-color: var(--panel-bg);
            padding: 20px;
            overflow-y: auto;
            border-left: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        /* MOBİL GÖRÜNÜM (Ekran 768px'den küçükse) */
        @media (max-width: 768px) {
            body {
                flex-direction: column;
            }
            
            .app-container {
                flex-direction: column;
            }

            .canvas-section {
                height: 50vh; /* Ekranın tam yarısı */
                flex: none;
                border-bottom: 2px solid var(--accent-color);
            }

            .controls-section {
                height: 50vh; /* Ekranın diğer yarısı */
                flex: none;
                width: 100%;
                border-left: none;
                padding: 15px;
            }
        }

        /* KONTROL ELEMANLARI STİLİ */
        h2 { margin: 0 0 10px 0; font-size: 1.2rem; color: var(--accent-color); }
        
        .control-group {
            background: rgba(255,255,255,0.03);
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #333;
        }

        label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            margin-bottom: 8px;
            color: #ccc;
        }

        .val-disp { color: var(--accent-color); font-weight: bold; }

        input[type="range"] {
            width: 100%;
            height: 6px;
            background: #444;
            border-radius: 3px;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            background: var(--accent-color);
            border-radius: 50%;
            cursor: pointer;
        }

        select {
            width: 100%;
            padding: 10px;
            background: #2a2a35;
            color: white;
            border: 1px solid var(--border-color);
            border-radius: 5px;
            font-size: 1rem;
            outline: none;
        }

        input[type="color"] {
            width: 100%;
            height: 40px;
            border: none;
            background: transparent;
            cursor: pointer;
        }

        button.reset-btn {
            background: #ff4757;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="app-container">
    <div class="canvas-section" id="canvasContainer">
        <canvas id="mainCanvas"></canvas>
    </div>

    <div class="controls-section">
        <h2>Desen Ayarları</h2>

        <div class="control-group">
            <label>Desen Modeli</label>
            <select id="patternSelect">
                <option value="1">Klasik Gül (Cos)</option>
                <option value="2">Papatya Stili (Sin)</option>
                <option value="3">Hibrit Gül (Cos + Sin)</option>
                <option value="4">Keskin Yapraklar (Küp)</option>
                <option value="5">Geniş Döngü (Limaçon)</option>
            </select>
        </div>

        <div class="control-group">
            <label>N Değeri (Yaprak Sayısı): <span id="nDisp" class="val-disp">3</span></label>
            <input type="range" id="nVal" min="1" max="20" step="1" value="3">
        </div>

        <div class="control-group">
            <label>D Değeri (Sıklık): <span id="dDisp" class="val-disp">5</span></label>
            <input type="range" id="dVal" min="1" max="20" step="1" value="5">
        </div>

        <div class="control-group">
            <label>Animasyon Hızı: <span id="speedDisp" class="val-disp">Orta</span></label>
            <input type="range" id="speedVal" min="1" max="50" step="1" value="10">
        </div>

        <div class="control-group">
            <label>Renk</label>
            <input type="color" id="colorVal" value="#00d2ff">
        </div>

        <div class="control-group">
            <label>Çizgi Kalınlığı: <span id="widthDisp" class="val-disp">2</span></label>
            <input type="range" id="widthVal" min="0.5" max="10" step="0.5" value="2">
        </div>
        
        <button class="reset-btn" onclick="resetDrawing()">Ekranı Temizle & Yeniden Başlat</button>
    </div>
</div>

<script>
    const canvas = document.getElementById('mainCanvas');
    const ctx = canvas.getContext('2d');
    const container = document.getElementById('canvasContainer');

    // Durum Değişkenleri
    let theta = 0; // Mevcut açı
    let animationId;
    let lastX = null;
    let lastY = null;
    
    // Ayarlar
    const settings = {
        n: 3,
        d: 5,
        speed: 0.05, // Açı artış hızı
        color: '#00d2ff',
        width: 2,
        scale: 150,
        pattern: '1'
    };

    // Eleman Seçimi
    const ui = {
        n: document.getElementById('nVal'),
        d: document.getElementById('dVal'),
        speed: document.getElementById('speedVal'),
        color: document.getElementById('colorVal'),
        width: document.getElementById('widthVal'),
        pattern: document.getElementById('patternSelect'),
        displays: {
            n: document.getElementById('nDisp'),
            d: document.getElementById('dDisp'),
            width: document.getElementById('widthDisp'),
            speed: document.getElementById('speedDisp')
        }
    };

    // Canvas Boyutlandırma
    function resizeCanvas() {
        const rect = container.getBoundingClientRect();
        canvas.width = rect.width;
        canvas.height = rect.height;
        
        // Mobil/Masaüstü ayrımına göre ölçeği ayarla
        settings.scale = Math.min(canvas.width, canvas.height) / 2.5;
        
        resetDrawing(); // Boyut değişince sıfırla
    }

    // Matematiksel Formüller
    function getRadius(k, t, type) {
        // k = n/d, t = theta
        switch(type) {
            case '1': return Math.cos(k * t); // Klasik
            case '2': return Math.sin(k * t); // Papatya
            case '3': return Math.cos(k * t) + Math.sin(k * t); // Hibrit
            case '4': return Math.pow(Math.cos(k * t), 3); // Keskin
            case '5': return 1 + 0.5 * Math.cos(k * t); // Limaçon tarzı
            default: return Math.cos(k * t);
        }
    }

    // Animasyon Döngüsü
    function animate() {
        const k = settings.n / settings.d;
        
        // Hıza göre döngü (hızlıysa bir karede birden çok çizgi çiz)
        // Kullanıcı arayüzündeki 1-50 değerini mantıklı bir döngü sayısına çeviriyoruz
        const stepsPerFrame = Math.ceil(settings.speedVal); 
        const stepSize = 0.02; // Açı adımı sabit, çizim kalitesi için

        ctx.strokeStyle = settings.color;
        ctx.lineWidth = settings.width;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';

        ctx.beginPath();
        
        // Çizim devamlılığı için moveTO
        if (lastX !== null) {
            ctx.moveTo(lastX, lastY);
        }

        for (let i = 0; i < stepsPerFrame; i++) {
            theta += stepSize;
            
            const r = getRadius(k, theta, settings.pattern) * settings.scale;
            
            const x = (canvas.width / 2) + (r * Math.cos(theta));
            const y = (canvas.height / 2) + (r * Math.sin(theta));
            
            ctx.lineTo(x, y);
            
            lastX = x;
            lastY = y;
        }
        
        ctx.stroke();

        animationId = requestAnimationFrame(animate);
    }

    // Ayarları Güncelleme ve Event Listenerlar
    function updateSettings(reset = false) {
        settings.n = parseFloat(ui.n.value);
        settings.d = parseFloat(ui.d.value);
        settings.color = ui.color.value;
        settings.width = parseFloat(ui.width.value);
        settings.pattern = ui.pattern.value;
        
        // Hız hesaplama (Slider 1-50 arası, bunu loop sayısına çeviriyoruz)
        settings.speedVal = parseFloat(ui.speed.value);

        // UI Metin Güncellemeleri
        ui.displays.n.textContent = settings.n;
        ui.displays.d.textContent = settings.d;
        ui.displays.width.textContent = settings.width;
        ui.displays.speed.textContent = settings.speedVal < 15 ? "Yavaş" : (settings.speedVal < 35 ? "Orta" : "Hızlı");

        if (reset) {
            resetDrawing();
        }
    }

    function resetDrawing() {
        // Ekranı temizle
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Değişkenleri sıfırla
        theta = 0;
        lastX = null;
        lastY = null;

        // Önceki animasyonu durdur ve yenisini başlat
        cancelAnimationFrame(animationId);
        animate();
    }

    // Event Listener Ekleme
    ui.n.addEventListener('input', () => updateSettings(true)); // Desen değişirse sıfırla
    ui.d.addEventListener('input', () => updateSettings(true)); // Desen değişirse sıfırla
    ui.pattern.addEventListener('change', () => updateSettings(true)); // Formül değişirse sıfırla
    
    ui.color.addEventListener('input', () => updateSettings(false)); // Renk değişirse devam et
    ui.width.addEventListener('input', () => updateSettings(false)); // Kalınlık değişirse devam et
    ui.speed.addEventListener('input', () => updateSettings(false)); // Hız değişirse devam et

    window.addEventListener('resize', resizeCanvas);

    // Başlangıç
    resizeCanvas();
    updateSettings();

</script>

</body>
</html>

